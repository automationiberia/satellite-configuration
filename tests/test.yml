---
- name: Test API Call 
  hosts: localhost
  gather_facts: false
  vars_files:
    - ../vars/test_vars.yml
  tasks:
    - name: API call
      ansible.builtin.uri:
        url: "{{ test.satellite.server_url }}/katello/api/repositories"
        method: GET
        user: "{{ test.satellite.admin.username }}"
        password: "{{ test.satellite.admin.password }}"
        force_basic_auth: true
        validate_certs: false
        return_content: true
        body_format: "json"
        body: "{\"types\":[\"rpm\"]}"
      register: result_api_response

    - name: Show result
      ansible.builtin.debug:
        var: result_api_response

#    - name: Template out 
#      ansible.builtin.template:
#        src: ../templates/test.yml.j2
#        dest: configs/test.yml
#        owner: "{{ test.satellite.template.owner }}"
#        group: "{{ test.satellite.template.group }}"
#        mode: "{{ test.satellite.template.mode }}"
